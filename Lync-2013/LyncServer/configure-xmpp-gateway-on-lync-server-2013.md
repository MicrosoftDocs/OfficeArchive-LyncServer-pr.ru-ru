---
title: Настройка шлюза XMPP на Lync Server 2013
description: Настройка шлюза XMPP на Lync Server 2013.
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
audience: Admin
f1.keywords:
- NOCSH
TOCTitle: Configure XMPP gateway on Lync Server 2013
ms:assetid: c70282e0-b502-47e2-a0be-a32eb1faf99d
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ721881(v=OCS.15)
ms:contentKeyID: 49733816
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 78765237e737dea29d77230d6b0eecdb0348cb41
ms.sourcegitcommit: 36fee89bb887bea4f18b19f17a8c69daf5bc423d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2020
ms.locfileid: "49398857"
---
# <a name="configure-xmpp-gateway-on-lync-server-2013"></a>Настройка шлюза XMPP на Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2013-10-28_

Последние шаги для миграции шлюза XMPP: Настройка сертификатов для пограничного сервера Lync Server 2013, развертывание шлюза Lync Server 2013 XMPP и обновление записей DNS для шлюза XMPP. Эти действия должны выполняться параллельно, чтобы свести к минимуму время, установленное на вашем шлюзе XMPP. Перед выполнением описанных ниже действий необходимо переместить всех пользователей в развертывание Microsoft Lync Server 2013.

<div class=" ">


> [!IMPORTANT]  
> XMPP Федерация не поддерживается для пользователей, которые размещаются на устройствах с возможностью бесперебойной ветви. Это относится и к сведениям о присутствии, и по обмену МГНОВЕНными сообщениями.



</div>

<div>

## <a name="configure-xmpp-gateway-certificates-on-the-lync-server-2013-edge-server"></a>Настройка сертификатов шлюза XMPP на пограничном сервере Lync Server 2013

1.  На пограничном сервере в мастере развертывания рядом с **шагом 3: запрос, установка и назначение сертификатов** нажмите кнопку **выполнить еще раз**.
    
    <div class=" ">
    

    > [!TIP]  
    > Если пограничный сервер развертывается в первый раз, вместо повторного запуска вы увидите "запустить".

    
    </div>

2.  На странице **Доступные задачи сертификатов** щелкните команду **Создать новый запрос сертификата**.

3.  На странице **запроса сертификата** выберите **внешний Граничный сертификат**.

4.  На странице **отложенный или немедленный запрос** установите флажок **подготовить запрос сейчас, но отправить позже** .

5.  На странице " **файл запроса сертификата** " введите полный путь и имя файла, в который нужно сохранить запрос (например, c: \\ CERT \_ exernal \_ Edge. cer).

6.  На странице " **Укажите другой шаблон сертификата** ", чтобы использовать шаблон, отличный от шаблона веб-сервера по умолчанию, установите флажок **использовать альтернативный шаблон сертификата для выбранного центра сертификации** .

7.  На странице **имя и параметры безопасности** выполните указанные ниже действия.
    
    1.  В поле **понятное имя** введите отображаемое имя сертификата.
    
    2.  В качестве **битовой длины** укажите длину в битах (обычно это значение по умолчанию — 2048).
    
    3.  Убедитесь, что установлен флажок " **помечать закрытый ключ сертификата как экспортируемый** ".

8.  На странице " **сведения об организации** " введите имя Организации и организационное подразделение (например, "подразделение" или "Отдел").

9.  На странице **сведения о географическом** расположении укажите сведения о местоположении.

10. На странице **имя субъекта/альтернативная тема** отображается информация, которая будет автоматически заполнена мастером. Если требуются дополнительные альтернативные имена субъектов, их можно указать в следующих двух шагах.

11. В **параметрах домена SIP на странице "альтернативные имена тем" (SAN)** установите флажок домен, чтобы добавить SIP.\<sipdomain\> элемент в список альтернативных имен субъектов.

12. На странице **Настройка дополнительных имен для других тем** укажите необходимые дополнительные имена субъектов.
    
    <div class=" ">
    

    > [!TIP]  
    > Если установлен прокси-сервер XMPP, по умолчанию доменное имя (например, contoso.com) заполнено в записях сети SAN. Если вам нужны дополнительные элементы, добавьте их на этом этапе.

    
    </div>

13. На странице **сводки запроса** ознакомьтесь со сведениями о сертификате, которые будут использоваться для создания запроса.

14. После завершения выполнения команд можно **Просмотреть журнал** или нажать кнопку Далее, чтобы продолжить.

15. На странице " **файл запроса на сертификат** " можно просмотреть созданный файл запроса на подписывание сертификата (CSR), щелкнув **Просмотреть** или выйти из мастера сертификатов, нажав кнопку **Готово**.

16. Скопируйте файл запроса и отправьте его в общедоступный центр сертификации.

17. После получения, импорта и назначения общедоступного сертификата вы должны остановить и перезапустить службы пограничного сервера. Для этого введите в консоль управления Lync Server:
    
        Stop-CsWindowsService

      &nbsp;
    
        Start-CsWindowsService

</div>

<div>

## <a name="configure-a-new-lync-server-2013-xmpp-gateway"></a>Настройка нового шлюза Lync Server 2013 XMPP

1.  Откройте Панель управления Lync Server.

2.  На панели навигации слева выберите пункт **интеграция и внешний доступ** , а затем — **XMPP Федеративные партнеры**.

3.  Чтобы создать новую конфигурацию, нажмите кнопку **создать**.

4.  Определите следующие параметры:

5.  **Основной домен**    (обязательно). Основной домен — это базовый домен партнера XMPP. Например, вы можете ввести **Fabrikam.com** для доменного имени XMPP партнера. Это обязательный элемент.

6.  **Description (описание**   )   Описание для заметок и другой идентифицирующей информации о конкретной конфигурации. Этот параметр является необязательным.

7.  **Дополнительные домены**   Дополнительные домены — это домены, являющиеся частью домена вашего партнера XMPP, которые должны быть включены в рамках разрешенного XMPP общения. Например, если основной домен — **Fabrikam.com**, вы увидите список всех остальных доменов, которые находятся в Fabrikam.com, с которыми вы будете общаться с помощью XMPP.

8.  **Тип партнера**   **Тип партнера** является обязательным параметром. Чтобы описать и принудительно добавить контакты, необходимо выбрать один из следующих вариантов: Вы можете выбрать один из следующих вариантов:
    
      - **Федеративное**   Тип **федеративного** партнера представляет высокий уровень доверия между развертыванием Lync Server и партнером по XMPP.  Этот тип партнера рекомендуется использовать для Федерации с серверами XMPP в рамках одного предприятия или там, где есть установленная деловая связь.  XMPPные контакты в федеративных партнерах могут:
        
        1.  Добавляйте контакты Lync и просматривайте их присутствие без использования быстрой авторизации пользователя Lync.
        
        2.  Отправляйте мгновенные сообщения в контакты Lync, не добавляя ли пользователь Lync в свой список контактов.
        
        3.  Ознакомьтесь с заметками о состоянии пользователя Lync.
    
      - **Общедоступная проверка**   **Общедоступный проверенный** партнер — это поставщик общедоступной XMPP, который является надежным для проверки подлинности пользователей.  XMPPные контакты в общедоступной проверенной сети могут добавлять контакты Lync и просматривать их присутствие и отправлять мгновенные сообщения без явного разрешения пользователей Lync.  XMPP контакты в общедоступной проверенной сети никогда не видят заметок о состоянии пользователей Lync.  Этот параметр не рекомендуется.
    
      - **Общедоступная непроверенная**   **Общедоступный непроверенный** партнер — это общедоступный поставщик XMPP, который не является доверенным для проверки подлинности пользователей.  Пользователи XMPP в общедоступных непроверенных сетях не смогут общаться с пользователями Lync, если пользователь Lync явно не предоставил их, добавив их в список контактов.  Пользователи XMPP в общедоступных непроверенных сетях не увидят заметок о состоянии пользователей Lync.  Этот параметр рекомендуется использовать для любой Федерации с общедоступными поставщиками XMPP, такими как Google поговорить.

9.  **Тип подключения:** Определяет различные параметры правил и dialback.
    
      - **Согласование TLS**   Определяет правила согласования TLS. Для службы XMPP может потребоваться TLS, может быть необязательным TLS или определено, что TLS не поддерживается. Если выбрать необязательный вариант, вы не сможете получить требование к службе XMPP для решения, которое является обязательным для согласования. Чтобы просмотреть все возможные параметры и сведения о согласовании SASL, TLS и Dialback, в том числе недопустимых и известных конфигураций ошибок, — [в разделе Параметры согласования XMPP федеративных партнеров в Lync Server 2013](lync-server-2013-negotiation-settings-for-xmpp-federated-partners.md).
        
          - <span></span>  
            **Обязательное требование**   Службе XMPP требуется согласование TLS.
        
          - <span></span>  
            **Необязательный**   Служба XMPP указывает, что протокол TLS является обязательным для согласования.
        
          - <span></span>  
            **Не поддерживается**   Служба XMPP не поддерживает TLS.
    
      - **Согласование SASL**   Определяет правила согласования SASL. Служба XMPP может потребовать SASL, может сделать SASL необязательной или определить, что SASL не поддерживается. Если выбрать необязательный вариант, вы не сможете получить требование к службе XMPP партнера, чтобы принять решение для принудительного согласования.
        
          - <span></span>  
            **Обязательное требование**   Для службы XMPP требуется согласование SASL.
        
          - <span></span>  
            **Необязательный**   Служба XMPP указывает, что SASL является обязательным для согласования.
        
          - <span></span>  
            **Не поддерживается**   Служба XMPP не поддерживает SASL.
    
      - **Dialback согласование серверной поддержки** Сервер службы поддержки dialback использует систему доменных имен (DNS) и удостоверяющий сервер, чтобы убедиться, что запрос был получен от действующего партнера XMPP. Для этого на исходном сервере создается сообщение определенного типа с созданным ключом dialback и выполняется поиск сервера-получателя в DNS. Сервер-источник отправляет ключ в потоке XML в конечный поиск DNS, предположительно на получающем сервере. При получении ключа над потоком XML, принимающий сервер не отвечает на исходный сервер, но отправляет ключ на известный полномочный сервер. Удостоверяющий сервер проверяет, является ли ключ допустимым или недействительным. Если это значение недействительно, принимающий сервер не отвечает на исходящий сервер. Если ключ является действительным, принимающий сервер информирует сервер источника о том, что удостоверение и ключ являются допустимыми, и может быть инициировано обсуждение.
        
        Существует два допустимых состояния для **согласования Dialback**:
        
          - <span></span>  
            **Значение истина**   Сервер XMPP настроен на использование согласования Dialback, если требуется получить запрос от сервера-источника.
        
          - <span></span>  
            **Ложь**   Сервер XMPP не настроен на использование согласования Dialback и если запрос должен быть получен от сервера-источника, он будет проигнорирован.

10. Нажмите **кнопку Сохранить,** чтобы сохранить изменения в политике сайта или пользователя.

</div>

<div>

## <a name="update-dns-records-for-lync-server-2013-xmpp-gateway"></a>Обновление записей DNS для Lync Server 2013 XMPP Gateway

1.  Чтобы настроить DNS для XMPP Федерации, добавьте следующую запись SRV на внешний DNS- \_ сервер: XMPP-Server. \_ Номера.\<domain name\> SRV-запись будет сопоставлена с полным доменным именем EDGE на пограничном сервере и значением порта 5269.

</div>

</div>

<span> </span>

</div>

</div>

</div>

