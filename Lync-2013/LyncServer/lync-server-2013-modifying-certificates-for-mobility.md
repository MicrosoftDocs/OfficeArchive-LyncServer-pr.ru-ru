---
title: 'Lync Server 2013: изменение сертификатов для мобильной работы'
description: 'Lync Server 2013: изменение сертификатов для мобильных устройств.'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Modifying certificates for mobility
ms:assetid: 4e9107af-20f4-4c2a-8c98-ca35b39a4e2d
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Hh690015(v=OCS.15)
ms:contentKeyID: 48184120
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 099122b1773c3f15d8ae0034ee5fa404225cdfd2
ms.sourcegitcommit: 36fee89bb887bea4f18b19f17a8c69daf5bc423d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "49445696"
---
# <a name="modifying-certificates-for-mobility-in-lync-server-2013"></a>Изменение сертификатов для мобильной работы в Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-06-20_

Для обеспечения защищенных подключений между средой Lync и мобильными клиентами вы должны обновить сертификаты SSL для вашего пула, пула и обратного прокси-сервера с некоторыми дополнительными записями альтернативных имен субъектов (SAN). Если вам нужно извлечь дополнительные сведения о требованиях к сертификатам для мобильных устройств, ознакомьтесь с разделом требования к сертификату в [технических требованиях для мобильных устройств в Lync Server 2013](lync-server-2013-technical-requirements-for-mobility.md), но в основном вам потребуется получить новые сертификаты из центра сертификации с дополнительными записями San, а затем добавить их, выполнив действия, описанные в этой статье.

Конечно, прежде чем приступить к работе, лучше узнать, какие другие имена уже есть у ваших сертификатов. Если вы не уверены в том, что уже настроено, вы можете узнать, как это сделать. Несмотря на то, что вы можете использовать команды **Get-CsCertificate** и других команд PowerShell для просмотра этих данных (что мы рассмотрим ниже) по умолчанию, что данные будут обрезаны, поэтому вам может не получиться Просмотреть все нужные свойства. Чтобы получить хорошее представление о сертификате и всех его свойствах, вы можете открыть консоль управления (MMC) и загрузить оснастку "сертификаты" (которую также можно проанализировать ниже) или просто установить мастер развертывания Lync Server.

Как указано выше, описанные выше действия помогут вам обновить сертификаты с помощью командной консоли Lync Server Management Shell и MMC. Если вы заинтересованы в использовании мастера сертификатов в мастере развертывания Lync Server, вы можете проверить [настройку сертификатов для режиссера в Lync server 2013](lync-server-2013-configure-certificates-for-the-director.md) для режиссера или режиссера, если вы настроили один из них (возможно, у вас нет). Для внешнего сервера или пула переднего плана вам потребуется [настроить сертификаты для серверов в Lync Server 2013](lync-server-2013-configure-certificates-for-servers.md).

Последнее, что следует помнить, — может иметься один сертификат по умолчанию в среде Lync Server 2013 или отдельные сертификаты для по умолчанию (все, кроме веб-служб), WebServicesExternal и WebServicesInternal. Если вы не хотите настраивать конфигурацию, вам помогут эти действия.

<div>

## <a name="to-update-certificates-with-new-subject-alternative-names-using-the-lync-server-management-shell"></a>Обновление сертификатов с использованием новых альтернативных имен для некоторых субъектов с помощью командной консоли Lync Server Management Shell

1.  Необходимо войти на сервер Lync Server 2013 с помощью учетной записи, обладающей правами и разрешениями локального администратора. Кроме того, если вы запускаете **запрос PowerShell — CsCertificate** на шагах 12 и более поздних, учетной записи должны быть предоставлены права на указанный центр сертификации (ЦС).

2.  Запустите командную консоль Lync Server Management Shell: нажмите кнопку **Пуск**, выберите **все программы**, а затем — **Microsoft Lync Server 2013**, а затем — **Командная консоль Lync Server Management Shell**.

3.  Прежде чем вы сможете назначить обновленный сертификат, вам нужно узнать, какие сертификаты были назначены серверу и для какого типа использования. В командной строке выполните следующую команду:
    
        Get-CsCertificate

4.  Просмотрите результаты предыдущего шага, чтобы узнать, назначен ли один сертификат для нескольких применений, или назначается ли другой сертификат для каждого использования. Чтобы узнать, как будет использоваться сертификат, найдите параметр Use. Сравните параметр отпечатка для выводимых сертификатов, чтобы узнать, используется ли один и тот же сертификат несколько. Проследите за параметром отпечатка.

5.  Обновите сертификат. В командной строке выполните следующую команду:
    
        Set-CsCertificate -Type <type of certificate as displayed in the Use parameter> -Thumbprint <unique identifier>
    
    Например, если командлет **Get-CsCertificate** показывает сертификат с использованием параметров по умолчанию, другой — с использованием WebServicesInternal, а другой — с помощью WebServicesExternal, и все они имеют одинаковое значение отпечатка, введите:
    
        Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
    
    **Важно!**
    
    Если вы назначаете отдельный сертификат для каждого использования (поэтому значение отпечатка, которое вы проверили выше для каждого сертификата), крайне важно, чтобы вы **не** выполняли командлет **Set-CsCertificate** с несколькими типами, как в приведенном выше примере. В этом случае выполните командлет **Set-CsCertificate** отдельно для каждого использования. Например:
    
        Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>

6.  Чтобы просмотреть сертификат (или сертификаты), нажмите кнопку **Пуск** и выберите команду **выполнить...**. Введите MMC, чтобы открыть консоль управления MMC.

7.  В меню MMC выберите пункт **файл**, а затем — **Добавить или удалить оснастку...**, выберите пункт Сертификаты. Нажмите **Добавить**. При появлении соответствующего запроса выберите пункт **учетная запись компьютера**, а затем нажмите кнопку **Далее**.

8.  Если это сервер, на котором находится сертификат, выберите **локальный компьютер**. Если сертификат расположен на другом компьютере, выберите **другой компьютер**, а затем введите полное доменное имя компьютера или нажмите кнопку **Обзор** в поле **введите имя нужного объекта** и введите имя компьютера. Нажмите кнопку **Проверить имена**. После разрешения имени компьютера оно будет подчеркнуто. Нажмите кнопку **ОК**, а затем — **Готово**. Нажмите кнопку **ОК** , чтобы завершить выбор и закрыть диалоговое окно **Добавление и удаление оснасток** .

9.  Чтобы просмотреть свойства сертификата, разверните раздел **Сертификаты** и выберите пункт **Личные**, а затем — **Сертификаты**. Выберите сертификат для просмотра, щелкните сертификат правой кнопкой мыши и выберите команду **Открыть**.

10. В представлении **сертификата** выберите **сведения**. Здесь вы можете выбрать имя субъекта сертификата, выделив **тему** , а также отобразить назначенное имя субъекта и связанные свойства.

11. Чтобы просмотреть назначенные альтернативные имена для темы, выберите **дополнительное имя субъекта**. Здесь отображаются все назначенные альтернативные имена для темы. Поиск по умолчанию альтернативных имен для темы имеет тип **DNS-имя** . Должны отобразиться следующие участники (все должны быть полные доменные имена, представленные в DNS-адресах (а или, если записи IPv6 AAAA).
    
      - Имя пула для этого пула или имя отдельного сервера, если он не является пулом
    
      - Имя сервера, которому назначен сертификат
    
      - Простые URL-записи, обычно соответствующие требованиям и набору номера
    
      - Внутренние имена внутренних и веб-служб (например, webpool01.contoso.net, webpool01.contoso.com), основанные на вариантах, сделанных в построителе топологии, и переопределяемые выборы веб-служб.
    
      - Если уже назначено, lyncdiscover.\<sipdomain\> и lyncdiscoverinternal.\<sipdomain\> строк.
    
    Последний элемент — это то, что вам интересно, если у тебя есть lyncdiscover и lyncdiscoverinternal сеть SAN.
    
    Если вы хотите проверить несколько сертификатов, повторите эти действия. После получения этих сведений вы можете закрыть представление сертификата и MMC.

12. Если отсутствует альтернативное имя субъекта службы автообнаружения и используется один сертификат по умолчанию для типов по умолчанию, WebServicesInternal и WebServiceExternal, выполните указанные ниже действия.
    
      - В командной строке оболочки Lync Server Management Shell введите:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр AllSipDomain. Вместо этого необходимо использовать параметр DomainName. Если вы используете параметр DomainName, вам нужно определить полное доменное имя для записей lyncdiscoverinternal и lyncdiscover. Например:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - Чтобы назначить сертификат, введите следующее:
        
            Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где "отпечаток" — это отпечаток для нового выданного сертификата.

13. Для отсутствующей внутренней сети SAN для автообнаружения при использовании отдельных сертификатов для параметров по умолчанию, WebServicesInternal и WebServicesExternal выполните указанные ниже действия.
    
      - В командной строке оболочки Lync Server Management Shell введите:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр AllSipDomain. Вместо этого необходимо использовать параметр DomainName. При использовании параметра DomainName вы можете использовать соответствующий префикс для доменного имени SIP domain. Например:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - Чтобы получить отсутствующее дополнительное имя для субъекта автообнаружения, в командной строке введите:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр AllSipDomain. Вместо этого необходимо использовать параметр DomainName. При использовании параметра DomainName вы можете использовать соответствующий префикс для доменного имени SIP domain. Например:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -DomainName "Lyncdiscover.contoso.com, Lyncdiscover.contoso.net" -verbose
    
      - Чтобы назначить индивидуальные типы сертификатов, введите следующую команду:
        
            Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где "отпечаток" — это отпечаток для вновь выданных индивидуальных сертификатов.
    
    <div>
    

    > [!NOTE]  
    > Обратите внимание, что шаги 12 и 13 должны выполняться только в том случае, если у учетной записи, с которой они работают, есть доступ к центру сертификации с необходимыми разрешениями. Если вы не можете войти в систему с помощью учетной записи, для которой у вас есть такие разрешения, или если у вас есть общедоступный или удаленный центр сертификации для ваших сертификатов, вам потребуется запросить их с помощью мастера развертывания Lync Server, который был использован в верхней части статьи.

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

